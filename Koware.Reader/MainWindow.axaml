<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:Koware.Reader"
        x:Class="Koware.Reader.MainWindow"
        x:DataType="local:MainWindow"
        Title="Koware Reader"
        Width="1000" Height="800"
        MinWidth="600" MinHeight="500"
        WindowStartupLocation="CenterScreen"
        Background="#1a1a2e"
        KeyDown="OnKeyDown">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" 
                Background="#0d0d1a"
                Padding="16,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                
                <TextBlock x:Name="TitleText"
                           Grid.Column="0"
                           Text="Koware Reader"
                           FontSize="16"
                           FontWeight="SemiBold"
                           Foreground="White"
                           VerticalAlignment="Center"
                           TextTrimming="CharacterEllipsis" />
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock x:Name="PageIndicator"
                               Text="Page 1 / 1"
                               Foreground="#888"
                               VerticalAlignment="Center"
                               Margin="0,0,16,0" />
                    
                    <!-- Zoom Controls -->
                    <Button Content="−"
                            FontSize="16"
                            FontWeight="Bold"
                            Click="OnZoomOutClick"
                            Background="#2a2a4a"
                            Foreground="White"
                            Width="32" Height="32"
                            Margin="0,0,4,0"
                            ToolTip.Tip="Zoom out (−)" />
                    <TextBlock x:Name="ZoomIndicator"
                               Text="100%"
                               Foreground="#888"
                               VerticalAlignment="Center"
                               Width="45"
                               TextAlignment="Center" />
                    <Button Content="+"
                            FontSize="16"
                            FontWeight="Bold"
                            Click="OnZoomInClick"
                            Background="#2a2a4a"
                            Foreground="White"
                            Width="32" Height="32"
                            Margin="0,0,12,0"
                            ToolTip.Tip="Zoom in (+)" />
                    
                    <Button x:Name="FitModeButton"
                            Content="Fit Width"
                            Click="OnFitModeClick"
                            Background="#2a2a4a"
                            Foreground="White"
                            Padding="12,6"
                            Margin="0,0,8,0"
                            ToolTip.Tip="Cycle fit mode (W)" />
                    
                    <Button x:Name="DoublePageButton"
                            Content="Single"
                            Click="OnDoublePageClick"
                            Background="#2a2a4a"
                            Foreground="White"
                            Padding="12,6"
                            Margin="0,0,8,0"
                            ToolTip.Tip="Toggle double-page view (D)" />
                    
                    <Button x:Name="FullscreenButton"
                            Content="⛶"
                            FontSize="16"
                            Click="OnFullscreenClick"
                            Background="#2a2a4a"
                            Foreground="White"
                            Width="36" Height="32"
                            Margin="0,0,8,0"
                            ToolTip.Tip="Fullscreen (F)" />
                    
                    <Button Content="?"
                            FontSize="14"
                            FontWeight="Bold"
                            Click="OnHelpCloseClick"
                            Background="#3a3a5a"
                            Foreground="#aaa"
                            Width="32" Height="32"
                            ToolTip.Tip="Keyboard shortcuts (H)" />
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Main Content -->
        <ScrollViewer x:Name="ScrollViewer"
                      Grid.Row="1"
                      HorizontalScrollBarVisibility="Auto"
                      VerticalScrollBarVisibility="Auto"
                      Background="#1a1a2e">
            <StackPanel x:Name="PagesContainer"
                        HorizontalAlignment="Center"
                        Margin="0,8">
                <!-- Pages will be added dynamically -->
            </StackPanel>
        </ScrollViewer>
        
        <!-- Loading Overlay -->
        <Border x:Name="LoadingOverlay"
                Grid.Row="1"
                Background="#cc1a1a2e"
                IsVisible="True">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Width="300">
                <TextBlock Text="Loading pages..."
                           Foreground="White"
                           FontSize="20"
                           HorizontalAlignment="Center" />
                <ProgressBar x:Name="LoadingProgressBar"
                             Minimum="0" Maximum="100" Value="0"
                             Height="8"
                             Margin="0,16,0,8"
                             Background="#333"
                             Foreground="#60a5fa" />
                <TextBlock x:Name="LoadingProgress"
                           Text="0 / 0"
                           Foreground="#888"
                           FontSize="14"
                           HorizontalAlignment="Center" />
            </StackPanel>
        </Border>
        
        <!-- Footer Navigation -->
        <Border Grid.Row="2"
                Background="#0d0d1a"
                Padding="16,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                
                <Button Grid.Column="0"
                        Content="← Previous"
                        Click="OnPreviousClick"
                        Background="#2a2a4a"
                        Foreground="White"
                        Padding="16,8" />
                
                <Slider x:Name="PageSlider"
                        Grid.Column="1"
                        Minimum="1" Maximum="1" Value="1"
                        Margin="16,0"
                        VerticalAlignment="Center"
                        ValueChanged="OnPageSliderChanged" />
                
                <Button Grid.Column="2"
                        Content="Next →"
                        Click="OnNextClick"
                        Background="#2a2a4a"
                        Foreground="White"
                        Padding="16,8" />
            </Grid>
        </Border>
        
        <!-- Help Overlay -->
        <Border x:Name="HelpOverlay"
                Grid.RowSpan="3"
                Background="#ee0d0d1a"
                IsVisible="False">
            <Border Background="#1a1a2e"
                    CornerRadius="12"
                    Padding="32"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    MinWidth="400">
                <StackPanel>
                    <TextBlock Text="Keyboard Shortcuts"
                               Foreground="White"
                               FontSize="20"
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,20" />
                    
                    <StackPanel Spacing="6">
                        <TextBlock Text="Navigation" Foreground="#888" FontWeight="SemiBold" Margin="0,0,0,4" />
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="← / →" Foreground="#60a5fa" FontFamily="Consolas" Width="100" />
                            <TextBlock Text="Previous / Next page" Foreground="#ccc" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Home / End" Foreground="#60a5fa" FontFamily="Consolas" Width="100" />
                            <TextBlock Text="First / Last page" Foreground="#ccc" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="1-9" Foreground="#60a5fa" FontFamily="Consolas" Width="100" />
                            <TextBlock Text="Jump to position in chapter" Foreground="#ccc" />
                        </StackPanel>
                        
                        <TextBlock Text="View" Foreground="#888" FontWeight="SemiBold" Margin="0,12,0,4" />
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="+ / −" Foreground="#60a5fa" FontFamily="Consolas" Width="100" />
                            <TextBlock Text="Zoom in / out" Foreground="#ccc" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Ctrl+Scroll" Foreground="#60a5fa" FontFamily="Consolas" Width="100" />
                            <TextBlock Text="Mouse wheel zoom" Foreground="#ccc" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="0" Foreground="#60a5fa" FontFamily="Consolas" Width="100" />
                            <TextBlock Text="Reset zoom to 100%" Foreground="#ccc" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="W" Foreground="#60a5fa" FontFamily="Consolas" Width="100" />
                            <TextBlock Text="Cycle fit mode" Foreground="#ccc" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="D" Foreground="#60a5fa" FontFamily="Consolas" Width="100" />
                            <TextBlock Text="Toggle double-page view" Foreground="#ccc" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="F / F11" Foreground="#60a5fa" FontFamily="Consolas" Width="100" />
                            <TextBlock Text="Toggle fullscreen" Foreground="#ccc" />
                        </StackPanel>
                        
                        <TextBlock Text="General" Foreground="#888" FontWeight="SemiBold" Margin="0,12,0,4" />
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="H / ?" Foreground="#60a5fa" FontFamily="Consolas" Width="100" />
                            <TextBlock Text="Show/hide this help" Foreground="#ccc" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Esc / Q" Foreground="#60a5fa" FontFamily="Consolas" Width="100" />
                            <TextBlock Text="Close reader" Foreground="#ccc" />
                        </StackPanel>
                    </StackPanel>
                    
                    <Button Content="Got it"
                            Click="OnHelpCloseClick"
                            Background="#3a3a5a"
                            Foreground="White"
                            Padding="24,8"
                            Margin="0,24,0,0"
                            HorizontalAlignment="Center" />
                </StackPanel>
            </Border>
        </Border>
        
        <!-- Error Overlay -->
        <Border x:Name="ErrorOverlay"
                Grid.RowSpan="3"
                Background="#ee1a1a2e"
                IsVisible="False">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="⚠"
                           Foreground="#f87171"
                           FontSize="48"
                           HorizontalAlignment="Center" />
                <TextBlock x:Name="ErrorText"
                           Text="Failed to load pages"
                           Foreground="#f87171"
                           FontSize="18"
                           HorizontalAlignment="Center"
                           Margin="0,16,0,0"
                           TextWrapping="Wrap"
                           MaxWidth="400" />
                <Button Content="Close"
                        Click="OnCloseClick"
                        Margin="0,24,0,0"
                        HorizontalAlignment="Center" />
            </StackPanel>
        </Border>
    </Grid>
</Window>
